<div class="content-heading">
    <div>
        <span>Analytics</span>
        <small>Transactions Analytics</small>
    </div>
</div>


<div class="row">
   <div class="col-sm-12">
      <div class="col-sm-12 col-centered">
         <!-- START bar chart-->
         <div id="panelChart3" class="card mb3 border-danger">
            <div class="card-header bg-danger">
               <div class="card-title">Transactions</div>
            </div>
            <div collapse="panelChart3" class="panel-wrapper">
               <div class="card-body" >
                  <div id="transactions_graph" style=" min-height: 400px; width: 100%; ">
                     <%= column_chart [
                        {name: "Withdrawals", data: @withdraws.map { |row| [row["date"].to_s, row["total_withdraw"].to_f] }.to_h },
                        {name: "Deposits", data: @deposits.map { |row| [row["date"].to_s, row["total_deposit"].to_f] }.to_h }
                     ],
                     height: "400px",
                     prefix: "UGX ",
                     thousands: ",",
                     library: {
                        title: { text: "Withdrawals and Deposits Over Time", x: -20 },
                        yAxis: {
                           title: { text: "Amount (UGX)" },
                           labels: { format: 'UGX {value:,.0f}' }
                        },
                        xAxis: { title: { text: "Date" }, type: 'datetime' },
                        tooltip: { valuePrefix: 'UGX ', valueSuffix: '' },
                        legend: { layout: 'vertical', align: 'right', verticalAlign: 'middle', borderWidth: 0 },
                        plotOptions: {
                           series: {
                              pointStart: (@withdraws&.first&.[]("date") || @deposits&.first&.[]("date") || Date.today).to_time.to_i * 1000,
                              pointInterval: 24 * 3600 * 1000 # one day
                           }
                        }
                     } %>
                  </div>
               </div>
            </div>
         </div>
         <!-- END bar chart-->
      </div>
   </div>
</div>
